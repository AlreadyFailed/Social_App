<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Config 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.cy.app.mapper.UserMapper">
    <update id="update">
        update users
        <set>
            <if test="phoneNum != null">
                phoneNum = #{phoneNum},
            </if>
            <if test="username != null and username != ''">
                username = #{username},
            </if>
            <if test="password != null and password != ''">
                password=#{password},
            </if>
            <if test="nickname != null and nickname != ''">
                nickname = #{nickname},
            </if>
            <if test="gender == 0 or gender == 1">
                gender=#{gender},
            </if>
            <if test="birthday != null">
                birthday = #{birthday},
            </if>
            <if test="age != null">
                age = #{age},
            </if>
            <if test="avatarSrc != null">
                avatar_src = #{avatarSrc},
            </if>
            <if test="weight != null">
                weight = #{weight},
            </if>
            <if test="heigth != null">
                heigth = #{heigth},
            </if>
            <if test="hobby != null and hobby != ''">
                hobby = #{hobby},
            </if>
            <if test="education != null and education != ''">
                education = #{education},
            </if>
            <if test="marry != null">
                marry = #{marry},
            </if>
            <if test="salary != null">
                salary = #{salary},
            </if>
            <if test="coordinateLat != null">
                coordinate_lat = #{coordinateLat},
            </if>
            <if test="coordinateLong != null">
                coordinate_long = #{coordinateLong},
            </if>
            <if test="updateTime != null">
                update_time = #{updateTime},
            </if>
            <if test="privilege != null">
                privilege = #{privilege},
            </if>
        </set>
        where phoneNum=#{phoneNum};
    </update>

    <select id="list" resultType="com.cy.app.pojo.Users">
        select * from users
        <where>
            <if test="name != null and name != ''">
                name like concat('%', #{name}, '%')
            </if>
            <if test="gender != null">
                and gender = #{gender}
            </if>
            <if test="begin != null and end != null">
                and create_time between #{begin} and #{end}
            </if>
        </where>
        order by update_time desc
    </select>

    <select id="friend" resultType="com.cy.app.pojo.Users">
        select * from users
        <where>
            <if test="gender != null">
                gender = #{gender}
            </if>
            <if test="education != null">
                and education = #{education}
            </if>
        </where>
        order by age desc;
    </select>
</mapper>